<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SocialConnect - Professional Networking</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #3B82F6;
            --secondary: #10B981;
            --accent: #EF4444;
            --dark: #1F2937;
            --light: #F3F4F6;
            --radius: 12px;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .dark {
            --dark: #F3F4F6;
            --light: #1F2937;
        }

        * {
            transition: background-color 0.3s, color 0.3s, transform 0.2s;
        }

        .connection-strength-weak {
            background: linear-gradient(90deg, var(--accent) 30%, #E5E7EB 30%);
        }
        .connection-strength-medium {
            background: linear-gradient(90deg, #F59E0B 60%, #E5E7EB 60%);
        }
        .connection-strength-strong {
            background-color: var(--secondary);
        }

        .fab {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 50;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .skeleton {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
            background-color: #E5E7EB;
            border-radius: var(--radius);
        }

        .network-node {
            transition: all 0.3s ease;
        }
        .network-node:hover {
            transform: scale(1.1);
            z-index: 10;
        }

        .toggle-checkbox:checked {
            right: 0;
            border-color: var(--primary);
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: var(--primary);
        }

        .nav-item.active {
            color: var(--primary);
            border-bottom: 2px solid var(--primary);
        }

        .tab-button.active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
            font-weight: 600;
        }

        .connection-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .connection-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100">
    <!-- Enhanced Header with Dark Mode Toggle -->
    <header class="bg-white dark:bg-gray-800 shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex items-center justify-between">
            <a href="index.html" class="flex items-center space-x-2">
                <i class="fas fa-link text-blue-500 text-2xl"></i>
                <span class="text-xl font-bold hidden md:inline">SocialConnect</span>
            </a>
            
            <button id="mobile-menu-button" class="md:hidden focus:outline-none">
                <i class="fas fa-bars text-xl"></i>
            </button>
            
            <nav class="hidden md:flex items-center space-x-8">
                <a href="index.html" class="nav-item group" title="Dashboard">
                    <div class="flex flex-col items-center">
                        <i class="fas fa-home text-xl"></i>
                        <span class="text-xs mt-1">Home</span>
                    </div>
                </a>
                <a href="connections.html" class="nav-item active group" title="Connections">
                    <div class="flex flex-col items-center">
                        <i class="fas fa-user-friends text-xl"></i>
                        <span class="text-xs mt-1">Network</span>
                    </div>
                </a>
                <a href="messages.html" class="nav-item group" title="Messages">
                    <div class="flex flex-col items-center">
                        <i class="fas fa-envelope text-xl"></i>
                        <span class="text-xs mt-1">Messages</span>
                    </div>
                </a>
                <a href="notifications.html" class="nav-item group" title="Notifications">
                    <div class="flex flex-col items-center relative">
                        <i class="fas fa-bell text-xl"></i>
                        <span class="text-xs mt-1">Alerts</span>
                        <span id="notification-badge" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center hidden">3</span>
                    </div>
                </a>
            </nav>
            
            <div class="hidden md:flex items-center space-x-4">
                <div class="relative inline-block w-12 mr-2 align-middle select-none">
                    <input type="checkbox" id="dark-mode-toggle" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer"/>
                    <label for="dark-mode-toggle" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
                </div>
                
                <button id="ai-assistant-btn" class="p-2 rounded-full bg-blue-100 dark:bg-gray-700 hover:bg-blue-200 dark:hover:bg-gray-600">
                    <i class="fas fa-robot text-blue-500"></i>
                </button>
                
                <div class="flex items-center space-x-2 cursor-pointer" id="user-profile">
                    <img id="header-profile-img" src="https://via.placeholder.com/40" alt="Profile" class="w-8 h-8 rounded-full object-cover">
                    <span class="font-medium hidden lg:inline" id="header-username">User</span>
                </div>
            </div>
        </div>
        
        <div id="mobile-menu" class="hidden md:hidden bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700">
            <div class="container mx-auto px-4 py-3 flex justify-around">
                <a href="index.html" class="nav-item active group" title="Dashboard">
                    <i class="fas fa-home text-xl"></i>
                </a>
                <a href="connections.html" class="nav-item group" title="Connections">
                    <i class="fas fa-user-friends text-xl"></i>
                </a>
                <a href="messages.html" class="nav-item group" title="Messages">
                    <i class="fas fa-envelope text-xl"></i>
                </a>
                <a href="notifications.html" class="nav-item group relative" title="Notifications">
                    <i class="fas fa-bell text-xl"></i>
                    <span id="mobile-notification-badge" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center hidden">3</span>
                </a>
                <button class="nav-item" id="mobile-profile-button">
                    <i class="fas fa-user text-xl"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-6">
        <!-- Network Health Overview -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 mb-6">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
                <div>
                    <h1 class="text-2xl font-bold">My Professional Network</h1>
                    <p class="text-gray-600 dark:text-gray-400">Your connections at a glance</p>
                </div>
                <div class="mt-4 md:mt-0">
                    <button id="new-connection-btn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2">
                        <i class="fas fa-plus"></i>
                        <span>New Connection</span>
                    </button>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <div class="bg-blue-50 dark:bg-gray-700 p-4 rounded-lg">
                    <div id="total-connections" class="text-blue-500 dark:text-blue-400 text-2xl font-bold">247</div>
                    <div class="text-gray-600 dark:text-gray-400">Total Connections</div>
                </div>
                <div class="bg-green-50 dark:bg-gray-700 p-4 rounded-lg">
                    <div id="new-connections" class="text-green-500 dark:text-green-400 text-2xl font-bold">12</div>
                    <div class="text-gray-600 dark:text-gray-400">New This Month</div>
                </div>
                <div class="bg-purple-50 dark:bg-gray-700 p-4 rounded-lg">
                    <div id="network-strength" class="text-purple-500 dark:text-purple-400 text-2xl font-bold">86%</div>
                    <div class="text-gray-600 dark:text-gray-400">Network Strength</div>
                </div>
                <div class="bg-yellow-50 dark:bg-gray-700 p-4 rounded-lg">
                    <div id="pending-requests" class="text-yellow-500 dark:text-yellow-400 text-2xl font-bold">5</div>
                    <div class="text-gray-600 dark:text-gray-400">Pending Requests</div>
                </div>
            </div>
            
            <!-- AI Recommendations -->
            <div class="bg-indigo-50 dark:bg-gray-700 rounded-lg p-4 mb-6">
                <div class="flex items-center mb-2">
                    <i class="fas fa-robot text-indigo-500 mr-2"></i>
                    <h3 class="font-semibold">AI Network Recommendations</h3>
                </div>
                <p class="text-gray-600 dark:text-gray-400 mb-3">Based on your activity, we recommend reconnecting with these contacts:</p>
                <div id="ai-recommendations" class="flex flex-wrap gap-2">
                    <!-- AI recommendations will be dynamically inserted here -->
                </div>
            </div>
        </div>
        
        <!-- Connection Management -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden">
            <div class="border-b border-gray-200 dark:border-gray-700">
                <nav class="flex -mb-px">
                    <button class="tab-button active" data-tab="all">
                        <i class="fas fa-users mr-2"></i>
                        All Connections
                        <span id="all-connections-count" class="ml-2 bg-blue-100 dark:bg-gray-700 text-blue-800 dark:text-blue-200 text-xs font-medium px-2 py-0.5 rounded-full">247</span>
                    </button>
                    <button class="tab-button" data-tab="pending">
                        <i class="fas fa-clock mr-2"></i>
                        Pending
                        <span id="pending-connections-count" class="ml-2 bg-yellow-100 dark:bg-gray-700 text-yellow-800 dark:text-yellow-200 text-xs font-medium px-2 py-0.5 rounded-full">5</span>
                    </button>
                    <button class="tab-button" data-tab="recent">
                        <i class="fas fa-history mr-2"></i>
                        Recent
                    </button>
                    <button class="tab-button" data-tab="groups">
                        <i class="fas fa-tags mr-2"></i>
                        Groups
                    </button>
                </nav>
            </div>
            
            <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                <div class="flex flex-col md:flex-row md:items-center space-y-3 md:space-y-0 md:space-x-3">
                    <div class="relative flex-grow">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-search text-gray-400"></i>
                        </div>
                        <input type="text" id="connections-search" class="block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Search connections...">
                    </div>
                    <select id="connections-filter" class="block w-full md:w-auto border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 py-2 px-3 pr-8 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="all">All Connections</option>
                        <option value="recent">Recently Active</option>
                        <option value="skills">By Skills</option>
                        <option value="location">By Location</option>
                        <option value="company">By Company</option>
                    </select>
                    <button id="advanced-filters-btn" class="bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 px-4 py-2 rounded-lg flex items-center space-x-2">
                        <i class="fas fa-sliders-h"></i>
                        <span>Advanced</span>
                    </button>
                </div>
            </div>
            
            <!-- Connections Grid -->
            <div class="p-4">
                <div id="connections-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                    <!-- Connection cards will be dynamically inserted here -->
                </div>
                
                <div id="loading-state" class="hidden">
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                        <div class="bg-white dark:bg-gray-700 rounded-lg overflow-hidden shadow-sm border border-gray-200 dark:border-gray-600">
                            <div class="p-4">
                                <div class="flex items-center space-x-3 mb-3">
                                    <div class="skeleton w-12 h-12 rounded-full"></div>
                                    <div class="flex-1">
                                        <div class="skeleton h-4 w-3/4 mb-2"></div>
                                        <div class="skeleton h-3 w-1/2"></div>
                                    </div>
                                </div>
                                <div class="skeleton h-3 w-full mb-2"></div>
                                <div class="skeleton h-3 w-5/6 mb-4"></div>
                                <div class="flex flex-wrap gap-2 mb-4">
                                    <div class="skeleton h-6 w-16 rounded-full"></div>
                                    <div class="skeleton h-6 w-12 rounded-full"></div>
                                    <div class="skeleton h-6 w-14 rounded-full"></div>
                                </div>
                                <div class="skeleton h-1 w-full rounded-full mb-3"></div>
                                <div class="skeleton h-3 w-1/2 mb-4"></div>
                                <div class="flex space-x-2">
                                    <div class="skeleton h-10 w-full rounded-lg"></div>
                                    <div class="skeleton h-10 w-10 rounded-lg"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="empty-state" class="hidden text-center py-12">
                    <i class="fas fa-user-friends text-4xl text-gray-400 mb-4"></i>
                    <h3 class="text-lg font-medium text-gray-700 dark:text-gray-300">No connections found</h3>
                    <p class="text-gray-500 dark:text-gray-400 mt-1">Try adjusting your search or filters</p>
                    <button id="refresh-connections" class="mt-4 bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg">
                        Refresh Connections
                    </button>
                </div>
                
                <div class="mt-6 flex items-center justify-between">
                    <button id="prev-page" class="bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg text-sm font-medium">
                        Previous
                    </button>
                    <div id="pagination" class="hidden md:flex space-x-1">
                        <!-- Pagination buttons will be dynamically inserted here -->
                    </div>
                    <button id="next-page" class="bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg text-sm font-medium">
                        Next
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Floating Action Button -->
    <button id="fab-btn" class="fab bg-blue-500 hover:bg-blue-600 text-white flex items-center justify-center">
        <i class="fas fa-plus text-xl"></i>
    </button>

    <!-- Profile Modal -->
    <div id="profile-modal" class="fixed inset-0 z-50 hidden overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 transition-opacity" aria-hidden="true">
                <div class="absolute inset-0 bg-gray-500 dark:bg-gray-900 opacity-75"></div>
            </div>
            
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
            
            <div class="inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
                <div class="px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <div class="sm:flex sm:items-start">
                        <div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 dark:bg-blue-900 sm:mx-0 sm:h-10 sm:w-10">
                            <i class="fas fa-user text-blue-500 dark:text-blue-300"></i>
                        </div>
                        <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
                            <h3 class="text-lg leading-6 font-medium text-gray-900 dark:text-gray-100" id="modal-title">
                                Edit Profile
                            </h3>
                            <div class="mt-2">
                                <p class="text-sm text-gray-500 dark:text-gray-400">
                                    Update your professional information to help others connect with you.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <form id="profile-form" class="mt-5">
                        <div class="grid grid-cols-1 gap-y-4">
                            <div>
                                <label for="profile-name" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Name</label>
                                <input type="text" id="profile-name" class="mt-1 block w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" required>
                            </div>
                            
                            <div>
                                <label for="profile-title" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Professional Title</label>
                                <input type="text" id="profile-title" class="mt-1 block w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" required>
                            </div>
                            
                            <div>
                                <label for="profile-bio" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Bio</label>
                                <textarea id="profile-bio" rows="3" class="mt-1 block w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" required></textarea>
                            </div>
                            
                            <div>
                                <label for="profile-skills" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Skills</label>
                                <input type="text" id="profile-skills" class="mt-1 block w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="Separate skills with commas" required>
                            </div>
                            
                            <div>
                                <label for="profile-location" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Location</label>
                                <input type="text" id="profile-location" class="mt-1 block w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" required>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Profile Photo</label>
                                <div class="mt-1 flex items-center">
                                    <span class="inline-block h-12 w-12 rounded-full overflow-hidden bg-gray-100 dark:bg-gray-600">
                                        <img id="profile-photo-preview" src="https://via.placeholder.com/48" alt="Profile" class="h-full w-full">
                                    </span>
                                    <button type="button" id="change-photo-btn" class="ml-5 bg-white dark:bg-gray-700 py-2 px-3 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                        Change
                                    </button>
                                    <input type="file" id="profile-photo-upload" class="hidden" accept="image/*">
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                
                <div class="bg-gray-50 dark:bg-gray-700 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                    <button type="button" id="save-profile-btn" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm">
                        Save Changes
                    </button>
                    <button type="button" class="close-modal mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 dark:border-gray-600 shadow-sm px-4 py-2 bg-white dark:bg-gray-600 text-base font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- New Connection Modal -->
    <div id="new-connection-modal" class="fixed inset-0 z-50 hidden overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 transition-opacity" aria-hidden="true">
                <div class="absolute inset-0 bg-gray-500 dark:bg-gray-900 opacity-75"></div>
            </div>
            
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
            
            <div class="inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
                <div class="px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <div class="sm:flex sm:items-start">
                        <div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 dark:bg-blue-900 sm:mx-0 sm:h-10 sm:w-10">
                            <i class="fas fa-user-plus text-blue-500 dark:text-blue-300"></i>
                        </div>
                        <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
                            <h3 class="text-lg leading-6 font-medium text-gray-900 dark:text-gray-100">
                                Connect with Professionals
                            </h3>
                            <div class="mt-2">
                                <p class="text-sm text-gray-500 dark:text-gray-400">
                                    Find and connect with professionals in your network
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-5">
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-search text-gray-400"></i>
                            </div>
                            <input type="text" id="find-connection-input" class="block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Search by name, company, or skills...">
                        </div>
                        
                        <div id="connection-results" class="mt-4 max-h-60 overflow-y-auto">
                            <!-- Connection search results will appear here -->
                        </div>
                    </div>
                </div>
                
                <div class="bg-gray-50 dark:bg-gray-700 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                    <button type="button" id="send-invitation-btn" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-500 text-base font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm">
                        Send Invitation
                    </button>
                    <button type="button" class="close-new-connection-modal mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 dark:border-gray-600 shadow-sm px-4 py-2 bg-white dark:bg-gray-600 text-base font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    
    <!-- Enhanced Script -->
    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAAxl0xBc_nLkTRO3XwiedbBD7Vj417i5M",
            authDomain: "smart-personal-helper.firebaseapp.com",
            projectId: "smart-personal-helper",
            storageBucket: "smart-personal-helper.appspot.com",
            messagingSenderId: "63071338320",
            appId: "1:63071338320:web:87851a90236a7df7ff3655",
            measurementId: "G-MP9GQJYTQC"
        };
        
        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // DOM Elements
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        const darkModeToggle = document.getElementById('dark-mode-toggle');
        const profileModal = document.getElementById('profile-modal');
        const newConnectionModal = document.getElementById('new-connection-modal');
        const tabButtons = document.querySelectorAll('.tab-button');
        const fabButton = document.getElementById('fab-btn');
        const newConnectionBtn = document.getElementById('new-connection-btn');
        const refreshConnectionsBtn = document.getElementById('refresh-connections');
        const saveProfileBtn = document.getElementById('save-profile-btn');
        const changePhotoBtn = document.getElementById('change-photo-btn');
        const photoUpload = document.getElementById('profile-photo-upload');
        const profileForm = document.getElementById('profile-form');
        const connectionsContainer = document.getElementById('connections-container');
        const aiRecommendations = document.getElementById('ai-recommendations');
        const connectionsSearch = document.getElementById('connections-search');
        const findConnectionInput = document.getElementById('find-connection-input');
        const connectionResults = document.getElementById('connection-results');
        const sendInvitationBtn = document.getElementById('send-invitation-btn');
        
        // State variables
        let currentUser = null;
        let userProfile = null;
        let allConnections = [];
        let filteredConnections = [];
        let currentTab = 'all';
        let currentPage = 1;
        const connectionsPerPage = 8;
        let selectedConnection = null;

        // Initialize the application
        function initApp() {
            auth.onAuthStateChanged(user => {
                if (user) {
                    currentUser = user;
                    loadUserProfile();
                    loadConnections();
                    loadNetworkMetrics();
                    loadAIRecommendations();
                } else {
                    window.location.href = 'login.html';
                }
            });
            
            setupEventListeners();
            checkDarkModePreference();
        }

        // Set up event listeners
        function setupEventListeners() {
            // Mobile menu toggle
            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });

            // Dark mode toggle
            darkModeToggle.addEventListener('change', () => {
                document.documentElement.classList.toggle('dark');
                localStorage.setItem('darkMode', document.documentElement.classList.contains('dark'));
            });

            // Profile modal
            document.getElementById('user-profile').addEventListener('click', () => {
                openProfileModal();
            });

            document.getElementById('mobile-profile-button').addEventListener('click', () => {
                openProfileModal();
            });

            // Close modals
            document.querySelectorAll('.close-modal').forEach(button => {
                button.addEventListener('click', () => {
                    profileModal.classList.add('hidden');
                });
            });

            document.querySelectorAll('.close-new-connection-modal').forEach(button => {
                button.addEventListener('click', () => {
                    newConnectionModal.classList.add('hidden');
                });
            });

            // Save profile
            saveProfileBtn.addEventListener('click', saveProfile);

            // Change profile photo
            changePhotoBtn.addEventListener('click', () => {
                photoUpload.click();
            });

            photoUpload.addEventListener('change', handlePhotoUpload);

            // Tabs
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    currentTab = button.dataset.tab;
                    filterConnections();
                    renderConnectionCards();
                });
            });

            // Search
            connectionsSearch.addEventListener('input', () => {
                filterConnections();
                renderConnectionCards();
            });

            // New connection
            fabButton.addEventListener('click', () => {
                newConnectionModal.classList.remove('hidden');
            });

            newConnectionBtn.addEventListener('click', () => {
                newConnectionModal.classList.remove('hidden');
            });

            // Refresh connections
            refreshConnectionsBtn?.addEventListener('click', loadConnections);

            // Pagination
            document.getElementById('prev-page').addEventListener('click', () => {
                if (currentPage > 1) {
                    currentPage--;
                    renderConnectionCards();
                }
            });

            document.getElementById('next-page').addEventListener('click', () => {
                const totalPages = Math.ceil(filteredConnections.length / connectionsPerPage);
                if (currentPage < totalPages) {
                    currentPage++;
                    renderConnectionCards();
                }
            });

            // AI Assistant
            document.getElementById('ai-assistant-btn').addEventListener('click', () => {
                alert('AI Assistant is coming soon!');
            });

            // Find connection
            findConnectionInput.addEventListener('input', searchConnections);

            // Send invitation
            sendInvitationBtn.addEventListener('click', sendConnectionRequest);
        }

        // Check dark mode preference
        function checkDarkModePreference() {
            if (localStorage.getItem('darkMode') === 'true') {
                document.documentElement.classList.add('dark');
                darkModeToggle.checked = true;
            }
        }

        // Load user profile
        async function loadUserProfile() {
            try {
                const doc = await db.collection('users').doc(currentUser.uid).get();
                if (doc.exists) {
                    userProfile = doc.data();
                    updateHeaderProfile();
                } else {
                    // Create a new profile if it doesn't exist
                    userProfile = {
                        name: currentUser.displayName || 'User',
                        title: '',
                        bio: '',
                        skills: '',
                        location: '',
                        profilePhoto: currentUser.photoURL || 'https://via.placeholder.com/40'
                    };
                    await db.collection('users').doc(currentUser.uid).set(userProfile);
                    updateHeaderProfile();
                }
            } catch (error) {
                console.error('Error loading profile:', error);
            }
        }

        // Update header with user profile
        function updateHeaderProfile() {
            document.getElementById('header-username').textContent = userProfile.name;
            document.getElementById('header-profile-img').src = userProfile.profilePhoto;
        }

        // Open profile modal
        function openProfileModal() {
            document.getElementById('profile-name').value = userProfile.name;
            document.getElementById('profile-title').value = userProfile.title;
            document.getElementById('profile-bio').value = userProfile.bio;
            document.getElementById('profile-skills').value = userProfile.skills;
            document.getElementById('profile-location').value = userProfile.location;
            document.getElementById('profile-photo-preview').src = userProfile.profilePhoto;
            profileModal.classList.remove('hidden');
        }

        // Handle photo upload
        function handlePhotoUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('profile-photo-preview').src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        // Save profile
        async function saveProfile() {
            if (!profileForm.checkValidity()) {
                profileForm.reportValidity();
                return;
            }

            try {
                userProfile = {
                    name: document.getElementById('profile-name').value,
                    title: document.getElementById('profile-title').value,
                    bio: document.getElementById('profile-bio').value,
                    skills: document.getElementById('profile-skills').value,
                    location: document.getElementById('profile-location').value,
                    profilePhoto: document.getElementById('profile-photo-preview').src
                };

                await db.collection('users').doc(currentUser.uid).set(userProfile);
                updateHeaderProfile();
                profileModal.classList.add('hidden');
                alert('Profile updated successfully!');
            } catch (error) {
                console.error('Error saving profile:', error);
                alert('Failed to save profile. Please try again.');
            }
        }

        // Load connections
        async function loadConnections() {
            try {
                showLoadingState();
                
                // Simulate API call delay
                setTimeout(async () => {
                    const snapshot = await db.collection('connections')
                        .where('userId', '==', currentUser.uid)
                        .get();
                    
                    allConnections = [];
                    snapshot.forEach(doc => {
                        const connection = doc.data();
                        connection.id = doc.id;
                        allConnections.push(connection);
                    });
                    
                    filterConnections();
                    renderConnectionCards();
                    hideLoadingState();
                }, 1000);
            } catch (error) {
                console.error('Error loading connections:', error);
                hideLoadingState();
                showEmptyState();
            }
        }

        // Filter connections based on current tab and search
        function filterConnections() {
            const searchTerm = connectionsSearch.value.toLowerCase();
            
            filteredConnections = allConnections.filter(connection => {
                // Apply tab filter
                if (currentTab === 'pending' && connection.status !== 'pending') return false;
                if (currentTab === 'recent' && !isRecent(connection.lastInteracted)) return false;
                
                // Apply search filter
                if (searchTerm) {
                    const nameMatch = connection.name.toLowerCase().includes(searchTerm);
                    const titleMatch = connection.title.toLowerCase().includes(searchTerm);
                    const companyMatch = connection.company.toLowerCase().includes(searchTerm);
                    const skillsMatch = connection.skills.some(skill => skill.toLowerCase().includes(searchTerm));
                    
                    if (!(nameMatch || titleMatch || companyMatch || skillsMatch)) return false;
                }
                
                return true;
            });
            
            // Update connection counts
            document.getElementById('all-connections-count').textContent = allConnections.length;
            const pendingCount = allConnections.filter(c => c.status === 'pending').length;
            document.getElementById('pending-connections-count').textContent = pendingCount;
            
            // Update pagination
            updatePagination();
        }

        // Render connection cards
        function renderConnectionCards() {
            connectionsContainer.innerHTML = '';
            
            if (filteredConnections.length === 0) {
                showEmptyState();
                return;
            }
            
            hideEmptyState();
            
            const startIndex = (currentPage - 1) * connectionsPerPage;
            const endIndex = Math.min(startIndex + connectionsPerPage, filteredConnections.length);
            const currentConnections = filteredConnections.slice(startIndex, endIndex);
            
            currentConnections.forEach(connection => {
                const card = createConnectionCard(connection);
                connectionsContainer.appendChild(card);
            });
        }

        // Create connection card element
        function createConnectionCard(connection) {
            const card = document.createElement('div');
            card.className = 'connection-card bg-white dark:bg-gray-700 rounded-lg overflow-hidden shadow-sm hover:shadow-md border border-gray-200 dark:border-gray-600';
            card.dataset.id = connection.id;
            
            let strengthClass = 'connection-strength-medium';
            if (connection.strength === 'strong') strengthClass = 'connection-strength-strong';
            if (connection.strength === 'weak') strengthClass = 'connection-strength-weak';
            
            let statusBadge = '';
            if (connection.status === 'pending') {
                statusBadge = `
                    <span class="text-xs bg-yellow-100 dark:bg-gray-600 text-yellow-800 dark:text-yellow-200 px-2 py-1 rounded-full">Pending</span>
                `;
            }
            
            let actionButtons = `
                <button class="flex-1 bg-blue-50 dark:bg-gray-600 hover:bg-blue-100 dark:hover:bg-gray-500 text-blue-600 dark:text-blue-300 py-2 px-3 rounded-lg text-sm font-medium flex items-center justify-center space-x-1 message-btn">
                    <i class="fas fa-comment"></i>
                    <span>Message</span>
                </button>
                <button class="flex-1 bg-gray-50 dark:bg-gray-600 hover:bg-gray-100 dark:hover:bg-gray-500 text-gray-600 dark:text-gray-300 py-2 px-3 rounded-lg text-sm font-medium flex items-center justify-center space-x-1 more-btn">
                    <i class="fas fa-ellipsis-h"></i>
                </button>
            `;
            
            if (connection.status === 'pending') {
                actionButtons = `
                    <button class="flex-1 bg-green-50 dark:bg-gray-600 hover:bg-green-100 dark:hover:bg-gray-500 text-green-600 dark:text-green-300 py-2 px-3 rounded-lg text-sm font-medium flex items-center justify-center space-x-1 accept-btn">
                        <i class="fas fa-check"></i>
                        <span>Accept</span>
                    </button>
                    <button class="flex-1 bg-red-50 dark:bg-gray-600 hover:bg-red-100 dark:hover:bg-gray-500 text-red-600 dark:text-red-300 py-2 px-3 rounded-lg text-sm font-medium flex items-center justify-center space-x-1 decline-btn">
                        <i class="fas fa-times"></i>
                        <span>Decline</span>
                    </button>
                `;
            }
            
            const skillsHTML = connection.skills.map(skill => `
                <span class="text-xs bg-gray-100 dark:bg-gray-600 text-gray-800 dark:text-gray-200 px-2 py-1 rounded-full">${skill}</span>
            `).join('');
            
            card.innerHTML = `
                <div class="p-4">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center space-x-3">
                            <div class="relative">
                                <img src="${connection.profilePhoto}" alt="Profile" class="w-12 h-12 rounded-full object-cover">
                                <span class="absolute bottom-0 right-0 block h-3 w-3 rounded-full ${connection.isOnline ? 'bg-green-500' : 'bg-gray-300'} ring-2 ring-white dark:ring-gray-700"></span>
                            </div>
                            <div>
                                <h3 class="font-semibold">${connection.name}</h3>
                                <p class="text-sm text-gray-600 dark:text-gray-400">${connection.title} @ ${connection.company}</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-1">
                            ${statusBadge}
                        </div>
                    </div>
                    
                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-4 line-clamp-2">${connection.bio}</p>
                    
                    <div class="flex flex-wrap gap-2 mb-4">
                        ${skillsHTML}
                    </div>
                    
                    <div class="${strengthClass} h-1 w-full rounded-full mb-3"></div>
                    <p class="text-xs text-gray-500 dark:text-gray-400 mb-4">Last interacted: ${formatDate(connection.lastInteracted)}</p>
                    
                    <div class="flex space-x-2">
                        ${actionButtons}
                    </div>
                </div>
            `;
            
            // Add event listeners
            if (connection.status === 'pending') {
                card.querySelector('.accept-btn').addEventListener('click', () => acceptConnection(connection.id));
                card.querySelector('.decline-btn').addEventListener('click', () => declineConnection(connection.id));
            } else {
                card.querySelector('.message-btn').addEventListener('click', () => messageConnection(connection.id));
                card.querySelector('.more-btn').addEventListener('click', () => showConnectionOptions(connection.id));
            }
            
            return card;
        }

        // Load network metrics
        async function loadNetworkMetrics() {
            try {
                // Simulate API call
                setTimeout(() => {
                    document.getElementById('total-connections').textContent = '247';
                    document.getElementById('new-connections').textContent = '12';
                    document.getElementById('network-strength').textContent = '86%';
                    document.getElementById('pending-requests').textContent = '5';
                }, 800);
            } catch (error) {
                console.error('Error loading metrics:', error);
            }
        }

        // Load AI recommendations
        async function loadAIRecommendations() {
            try {
                // Simulate AI recommendations
                const recommendations = [
                    { id: 'rec1', name: 'Sarah Johnson', profilePhoto: 'https://via.placeholder.com/30' },
                    { id: 'rec2', name: 'Michael Chen', profilePhoto: 'https://via.placeholder.com/30' },
                    { id: 'rec3', name: 'David Wilson', profilePhoto: 'https://via.placeholder.com/30' }
                ];
                
                aiRecommendations.innerHTML = '';
                
                recommendations.forEach(rec => {
                    const recElement = document.createElement('span');
                    recElement.className = 'bg-white dark:bg-gray-600 px-3 py-1 rounded-full text-sm flex items-center cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-500';
                    recElement.innerHTML = `
                        <img src="${rec.profilePhoto}" class="w-4 h-4 rounded-full mr-2">
                        ${rec.name}
                    `;
                    recElement.addEventListener('click', () => {
                        alert(`Showing profile for ${rec.name}`);
                    });
                    aiRecommendations.appendChild(recElement);
                });
            } catch (error) {
                console.error('Error loading AI recommendations:', error);
            }
        }

        // Search connections for new connection modal
        async function searchConnections() {
            const searchTerm = findConnectionInput.value.trim().toLowerCase();
            
            if (searchTerm.length < 2) {
                connectionResults.innerHTML = '<p class="text-gray-500 text-center py-4">Start typing to find connections</p>';
                return;
            }
            
            try {
                // Simulate API call
                setTimeout(() => {
                    const mockResults = [
                        { 
                            id: 'user1', 
                            name: 'Alex Morgan', 
                            title: 'Senior Designer', 
                            company: 'Creative Solutions',
                            profilePhoto: 'https://via.placeholder.com/40',
                            skills: ['UI/UX', 'Figma', 'Illustration']
                        },
                        { 
                            id: 'user2', 
                            name: 'Taylor Smith', 
                            title: 'Product Manager', 
                            company: 'Tech Innovations',
                            profilePhoto: 'https://via.placeholder.com/40',
                            skills: ['Product Strategy', 'Agile', 'User Research']
                        },
                        { 
                            id: 'user3', 
                            name: 'Jordan Lee', 
                            title: 'Data Scientist', 
                            company: 'Data Insights Co',
                            profilePhoto: 'https://via.placeholder.com/40',
                            skills: ['Python', 'Machine Learning', 'Data Visualization']
                        }
                    ];
                    
                    connectionResults.innerHTML = '';
                    
                    if (mockResults.length === 0) {
                        connectionResults.innerHTML = '<p class="text-gray-500 text-center py-4">No results found</p>';
                        return;
                    }
                    
                    mockResults.forEach(user => {
                        const userElement = document.createElement('div');
                        userElement.className = 'flex items-center p-3 hover:bg-gray-100 dark:hover:bg-gray-600 cursor-pointer';
                        userElement.dataset.id = user.id;
                        
                        userElement.innerHTML = `
                            <img src="${user.profilePhoto}" alt="Profile" class="w-10 h-10 rounded-full mr-3">
                            <div class="flex-1">
                                <h4 class="font-medium">${user.name}</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-400">${user.title} @ ${user.company}</p>
                                <div class="flex flex-wrap gap-1 mt-1">
                                    ${user.skills.slice(0, 3).map(skill => `
                                        <span class="text-xs bg-gray-200 dark:bg-gray-700 px-2 py-0.5 rounded-full">${skill}</span>
                                    `).join('')}
                                </div>
                            </div>
                            <input type="radio" name="selected-connection" class="h-4 w-4 text-blue-500">
                        `;
                        
                        userElement.addEventListener('click', (e) => {
                            if (e.target.type !== 'radio') {
                                const radio = userElement.querySelector('input[type="radio"]');
                                radio.checked = !radio.checked;
                                if (radio.checked) {
                                    selectedConnection = user;
                                } else {
                                    selectedConnection = null;
                                }
                            }
                        });
                        
                        connectionResults.appendChild(userElement);
                    });
                }, 500);
            } catch (error) {
                console.error('Error searching connections:', error);
                connectionResults.innerHTML = '<p class="text-red-500 text-center py-4">Error loading results</p>';
            }
        }

        // Send connection request
        async function sendConnectionRequest() {
            if (!selectedConnection) {
                alert('Please select a connection to invite');
                return;
            }
            
            try {
                // Simulate API call
                setTimeout(() => {
                    alert(`Connection request sent to ${selectedConnection.name}`);
                    newConnectionModal.classList.add('hidden');
                    selectedConnection = null;
                    findConnectionInput.value = '';
                    connectionResults.innerHTML = '<p class="text-gray-500 text-center py-4">Start typing to find connections</p>';
                }, 800);
            } catch (error) {
                console.error('Error sending connection request:', error);
                alert('Failed to send connection request. Please try again.');
            }
        }

        // Accept connection
        async function acceptConnection(connectionId) {
            try {
                // Simulate API call
                setTimeout(() => {
                    alert('Connection accepted');
                    // Refresh connections
                    loadConnections();
                }, 800);
            } catch (error) {
                console.error('Error accepting connection:', error);
                alert('Failed to accept connection. Please try again.');
            }
        }

        // Decline connection
        async function declineConnection(connectionId) {
            try {
                // Simulate API call
                setTimeout(() => {
                    alert('Connection declined');
                    // Refresh connections
                    loadConnections();
                }, 800);
            } catch (error) {
                console.error('Error declining connection:', error);
                alert('Failed to decline connection. Please try again.');
            }
        }

        // Message connection
        function messageConnection(connectionId) {
            alert('Opening chat with connection');
            // In a real app, this would redirect to the chat page
        }

        // Show connection options
        function showConnectionOptions(connectionId) {
            alert('Showing options for connection');
            // In a real app, this would show a context menu
        }

        // Helper functions
        function formatDate(timestamp) {
            const date = new Date(timestamp);
            const now = new Date();
            const diffDays = Math.floor((now - date) / (1000 * 60 * 60 * 24));
            
            if (diffDays === 0) return 'Today';
            if (diffDays === 1) return 'Yesterday';
            if (diffDays < 7) return `${diffDays} days ago`;
            if (diffDays < 30) return `${Math.floor(diffDays/7)} weeks ago`;
            return date.toLocaleDateString();
        }

        function isRecent(timestamp) {
            const date = new Date(timestamp);
            const now = new Date();
            return (now - date) < (30 * 24 * 60 * 60 * 1000); // Within 30 days
        }

        function showLoadingState() {
            document.getElementById('loading-state').classList.remove('hidden');
            document.getElementById('connections-container').classList.add('hidden');
            document.getElementById('empty-state').classList.add('hidden');
        }

        function hideLoadingState() {
            document.getElementById('loading-state').classList.add('hidden');
            document.getElementById('connections-container').classList.remove('hidden');
        }

        function showEmptyState() {
            document.getElementById('empty-state').classList.remove('hidden');
            document.getElementById('connections-container').classList.add('hidden');
            document.getElementById('loading-state').classList.add('hidden');
        }

        function hideEmptyState() {
            document.getElementById('empty-state').classList.add('hidden');
        }

        function updatePagination() {
            const totalPages = Math.ceil(filteredConnections.length / connectionsPerPage);
            const paginationContainer = document.getElementById('pagination');
            
            if (totalPages <= 1) {
                paginationContainer.classList.add('hidden');
                return;
            }
            
            paginationContainer.classList.remove('hidden');
            paginationContainer.innerHTML = '';
            
            const maxVisiblePages = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
            let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
            
            if (endPage - startPage + 1 < maxVisiblePages) {
                startPage = Math.max(1, endPage - maxVisiblePages + 1);
            }
            
            if (startPage > 1) {
                const firstPageBtn = document.createElement('button');
                firstPageBtn.className = 'w-10 h-10 hover:bg-gray-100 dark:hover:bg-gray-600 rounded-lg';
                firstPageBtn.textContent = '1';
                firstPageBtn.addEventListener('click', () => {
                    currentPage = 1;
                    renderConnectionCards();
                });
                paginationContainer.appendChild(firstPageBtn);
                
                if (startPage > 2) {
                    const ellipsis = document.createElement('span');
                    ellipsis.className = 'flex items-center px-2';
                    ellipsis.textContent = '...';
                    paginationContainer.appendChild(ellipsis);
                }
            }
            
            for (let i = startPage; i <= endPage; i++) {
                const pageBtn = document.createElement('button');
                pageBtn.className = `w-10 h-10 rounded-lg ${i === currentPage ? 'bg-blue-500 text-white' : 'hover:bg-gray-100 dark:hover:bg-gray-600'}`;
                pageBtn.textContent = i;
                pageBtn.addEventListener('click', () => {
                    currentPage = i;
                    renderConnectionCards();
                });
                paginationContainer.appendChild(pageBtn);
            }
            
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    const ellipsis = document.createElement('span');
                    ellipsis.className = 'flex items-center px-2';
                    ellipsis.textContent = '...';
                    paginationContainer.appendChild(ellipsis);
                }
                
                const lastPageBtn = document.createElement('button');
                lastPageBtn.className = 'w-10 h-10 hover:bg-gray-100 dark:hover:bg-gray-600 rounded-lg';
                lastPageBtn.textContent = totalPages;
                lastPageBtn.addEventListener('click', () => {
                    currentPage = totalPages;
                    renderConnectionCards();
                });
                paginationContainer.appendChild(lastPageBtn);
            }
        }

        // Initialize the app when the DOM is loaded
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>